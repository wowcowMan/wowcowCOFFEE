(self["webpackChunkwowcofee_project"]=self["webpackChunkwowcofee_project"]||[]).push([[382],{7972:function(e,t,i){
/*!
  * Bootstrap modal.js v5.3.0-alpha3 (https://getbootstrap.com/)
  * Copyright 2011-2023 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */
(function(t,s){e.exports=s(i(1884),i(4130),i(7317),i(632),i(9069),i(5160),i(1437),i(7547))})(0,(function(e,t,i,s,a,n,l,d){"use strict";const o="modal",r="bs.modal",h=`.${r}`,c=".data-api",u="Escape",_=`hide${h}`,m=`hidePrevented${h}`,p=`hidden${h}`,g=`show${h}`,b=`shown${h}`,w=`resize${h}`,f=`click.dismiss${h}`,y=`mousedown.dismiss${h}`,k=`keydown.dismiss${h}`,v=`click${h}${c}`,$="modal-open",O="fade",D="show",C="modal-static",x=".modal.show",M=".modal-dialog",z=".modal-body",L='[data-bs-toggle="modal"]',P={backdrop:!0,focus:!0,keyboard:!0},T={backdrop:"(boolean|string)",focus:"boolean",keyboard:"boolean"};class A extends e{constructor(e,t){super(e,t),this._dialog=i.findOne(M,this._element),this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._isShown=!1,this._isTransitioning=!1,this._scrollBar=new d,this._addEventListeners()}static get Default(){return P}static get DefaultType(){return T}static get NAME(){return o}toggle(e){return this._isShown?this.hide():this.show(e)}show(e){if(this._isShown||this._isTransitioning)return;const i=t.trigger(this._element,g,{relatedTarget:e});i.defaultPrevented||(this._isShown=!0,this._isTransitioning=!0,this._scrollBar.hide(),document.body.classList.add($),this._adjustDialog(),this._backdrop.show((()=>this._showElement(e))))}hide(){if(!this._isShown||this._isTransitioning)return;const e=t.trigger(this._element,_);e.defaultPrevented||(this._isShown=!1,this._isTransitioning=!0,this._focustrap.deactivate(),this._element.classList.remove(D),this._queueCallback((()=>this._hideModal()),this._element,this._isAnimated()))}dispose(){t.off(window,h),t.off(this._dialog,h),this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}handleUpdate(){this._adjustDialog()}_initializeBackDrop(){return new s({isVisible:Boolean(this._config.backdrop),isAnimated:this._isAnimated()})}_initializeFocusTrap(){return new n({trapElement:this._element})}_showElement(e){document.body.contains(this._element)||document.body.append(this._element),this._element.style.display="block",this._element.removeAttribute("aria-hidden"),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.scrollTop=0;const s=i.findOne(z,this._dialog);s&&(s.scrollTop=0),l.reflow(this._element),this._element.classList.add(D);const a=()=>{this._config.focus&&this._focustrap.activate(),this._isTransitioning=!1,t.trigger(this._element,b,{relatedTarget:e})};this._queueCallback(a,this._dialog,this._isAnimated())}_addEventListeners(){t.on(this._element,k,(e=>{e.key===u&&(this._config.keyboard?this.hide():this._triggerBackdropTransition())})),t.on(window,w,(()=>{this._isShown&&!this._isTransitioning&&this._adjustDialog()})),t.on(this._element,y,(e=>{t.one(this._element,f,(t=>{this._element===e.target&&this._element===t.target&&("static"!==this._config.backdrop?this._config.backdrop&&this.hide():this._triggerBackdropTransition())}))}))}_hideModal(){this._element.style.display="none",this._element.setAttribute("aria-hidden",!0),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._isTransitioning=!1,this._backdrop.hide((()=>{document.body.classList.remove($),this._resetAdjustments(),this._scrollBar.reset(),t.trigger(this._element,p)}))}_isAnimated(){return this._element.classList.contains(O)}_triggerBackdropTransition(){const e=t.trigger(this._element,m);if(e.defaultPrevented)return;const i=this._element.scrollHeight>document.documentElement.clientHeight,s=this._element.style.overflowY;"hidden"===s||this._element.classList.contains(C)||(i||(this._element.style.overflowY="hidden"),this._element.classList.add(C),this._queueCallback((()=>{this._element.classList.remove(C),this._queueCallback((()=>{this._element.style.overflowY=s}),this._dialog)}),this._dialog),this._element.focus())}_adjustDialog(){const e=this._element.scrollHeight>document.documentElement.clientHeight,t=this._scrollBar.getWidth(),i=t>0;if(i&&!e){const e=l.isRTL()?"paddingLeft":"paddingRight";this._element.style[e]=`${t}px`}if(!i&&e){const e=l.isRTL()?"paddingRight":"paddingLeft";this._element.style[e]=`${t}px`}}_resetAdjustments(){this._element.style.paddingLeft="",this._element.style.paddingRight=""}static jQueryInterface(e,t){return this.each((function(){const i=A.getOrCreateInstance(this,e);if("string"===typeof e){if("undefined"===typeof i[e])throw new TypeError(`No method named "${e}"`);i[e](t)}}))}}return t.on(document,v,L,(function(e){const s=i.getElementFromSelector(this);["A","AREA"].includes(this.tagName)&&e.preventDefault(),t.one(s,g,(e=>{e.defaultPrevented||t.one(s,p,(()=>{l.isVisible(this)&&this.focus()}))}));const a=i.findOne(x);a&&A.getInstance(a).hide();const n=A.getOrCreateInstance(s);n.toggle(this)})),a.enableDismissTrigger(A),l.defineJQueryPlugin(A),A}))},1339:function(e,t,i){"use strict";var s=i(7972),a=i.n(s);t["Z"]={methods:{showModal(){this.modal.show()},hideModal(){this.modal.hide()}},mounted(){this.modal=new(a())(this.$refs.modal)}}},7823:function(e,t,i){"use strict";i.d(t,{Z:function(){return k}});var s=i(3396),a=i(7139);const n={class:"modal fade",id:"delModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"modal"},l={class:"modal-dialog",role:"document"},d={class:"modal-content border-0"},o={class:"modal-header bg-danger text-white"},r={class:"modal-title"},h=(0,s._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),c={class:"modal-body"},u={class:"text-danger"},_={class:"modal-footer"},m=(0,s._)("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"},"取消 ",-1),p=["disabled"];function g(e,t,i,g,b,w){return(0,s.wg)(),(0,s.iD)("div",n,[(0,s._)("div",l,[(0,s._)("div",d,[(0,s._)("div",o,[(0,s._)("h5",r,[(0,s._)("span",null,"刪除 "+(0,a.zw)(i.item.title),1)]),h]),(0,s._)("div",c,[(0,s.Uk)(" 是否刪除 "),(0,s._)("strong",u,(0,a.zw)(i.item.title),1),(0,s.Uk)(" (刪除後將無法恢復)。 ")]),(0,s._)("div",_,[m,(0,s._)("button",{type:"button",disabled:b.isChecked,class:"btn btn-danger",onClick:t[0]||(t[0]=t=>e.$emit("del-item"))},"確認刪除 ",8,p)])])])],512)}var b=i(1339),w={props:{item:{}},data(){return{modal:"",isChecked:!1}},mixins:[b.Z]},f=i(89);const y=(0,f.Z)(w,[["render",g]]);var k=y},8534:function(e,t,i){"use strict";i.d(t,{Z:function(){return y}});var s=i(3396),a=i(7139),n=i(9242);const l=e=>((0,s.dD)("data-v-f11b9b82"),e=e(),(0,s.Cn)(),e),d={"aria-label":"Page navigation example"},o={class:"pagination justify-content-center"},r={class:"page-item"},h=l((()=>(0,s._)("span",{"aria-hidden":"true"},"«",-1))),c=[h],u=["onClick"],_={class:"page-item"},m=l((()=>(0,s._)("span",{"aria-hidden":"true"},"»",-1))),p=[m];function g(e,t,i,l,h,m){return(0,s.wg)(),(0,s.iD)("nav",d,[(0,s._)("ul",o,[(0,s._)("li",r,[(0,s._)("a",{class:(0,a.C_)(["page-link border-0",{"d-none":1===Number(this.$route.query.page)}]),href:"#","aria-label":"Previous",onClick:t[0]||(t[0]=(0,n.iM)((e=>m.prevNext(-1)),["prevent"]))},c,2)]),((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(i.pages,(e=>((0,s.wg)(),(0,s.iD)("li",{class:(0,a.C_)(["page-item",{active:e===Number(this.$route.query.page)}]),key:e},[(0,s._)("a",{class:"page-link border-0",href:"#",onClick:(0,n.iM)((t=>m.updatePage(e)),["prevent"])},(0,a.zw)(e),9,u)],2)))),128)),(0,s._)("li",_,[(0,s._)("a",{class:(0,a.C_)(["page-link border-0",{"d-none":Number(this.$route.query.page)===i.pages}]),href:"#","aria-label":"Next",onClick:t[1]||(t[1]=(0,n.iM)((e=>m.prevNext(1)),["prevent"]))},p,2)])])])}var b={props:["pages","current_page"],methods:{updatePage(e){this.$emit("emit-pages",e)},prevNext(e){this.$emit("emit-prevnext",e)}}},w=i(89);const f=(0,w.Z)(b,[["render",g],["__scopeId","data-v-f11b9b82"]]);var y=f},5382:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return re}});var s=i(3396),a=i(7139),n=i(9242);const l={class:"table mt-4"},d=(0,s._)("thead",null,[(0,s._)("tr",null,[(0,s._)("th",null,"購買時間"),(0,s._)("th",null,"Email"),(0,s._)("th",null,"購買款項"),(0,s._)("th",null,"應付金額"),(0,s._)("th",null,"是否付款"),(0,s._)("th",null,"編輯")])],-1),o=["textContent"],r={class:"list-unstyled"},h={class:"text-right"},c={class:"form-check form-switch"},u=["id","onUpdate:modelValue","onChange"],_=["for"],m={key:0},p={key:1},g={class:"btn-group"},b=["onClick"],w=["onClick"];function f(e,t,i,f,y,k){const v=(0,s.up)("Loading"),$=(0,s.up)("OrderModal"),O=(0,s.up)("DelModal"),D=(0,s.up)("Pagination");return(0,s.wg)(),(0,s.iD)(s.HY,null,[(0,s.Wm)(v,{active:y.isLoading},null,8,["active"]),(0,s._)("table",l,[d,(0,s._)("tbody",null,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(y.orders,((t,i)=>((0,s.wg)(),(0,s.iD)(s.HY,{key:i},[y.orders.length?((0,s.wg)(),(0,s.iD)("tr",{key:0,class:(0,a.C_)({"text-secondary":!t.is_paid})},[(0,s._)("td",null,(0,a.zw)(e.$filters.date(t.create_at)),1),(0,s._)("td",null,[t.user?((0,s.wg)(),(0,s.iD)("span",{key:0,textContent:(0,a.zw)(t.user.email)},null,8,o)):(0,s.kq)("",!0)]),(0,s._)("td",null,[(0,s._)("ul",r,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(t.products,((e,t)=>((0,s.wg)(),(0,s.iD)("li",{key:t},(0,a.zw)(e.product.title)+" 數量："+(0,a.zw)(e.qty)+" "+(0,a.zw)(e.product.unit),1)))),128))])]),(0,s._)("td",h,(0,a.zw)(t.total),1),(0,s._)("td",null,[(0,s._)("div",c,[(0,s.wy)((0,s._)("input",{class:"form-check-input",type:"checkbox",id:`paidSwitch${t.id}`,"onUpdate:modelValue":e=>t.is_paid=e,onChange:e=>k.updatePaid(t)},null,40,u),[[n.e8,t.is_paid]]),(0,s._)("label",{class:"form-check-label",for:`paidSwitch${t.id}`},[t.is_paid?((0,s.wg)(),(0,s.iD)("span",m,"已付款")):((0,s.wg)(),(0,s.iD)("span",p,"未付款"))],8,_)])]),(0,s._)("td",null,[(0,s._)("div",g,[(0,s._)("button",{class:"btn btn-outline-primary btn-sm",onClick:e=>k.openModal(t)},"檢視",8,b),(0,s._)("button",{class:"btn btn-outline-danger btn-sm",onClick:e=>k.openDelOrderModal(t)},"刪除",8,w)])])],2)):(0,s.kq)("",!0)],64)))),128))])]),(0,s.Wm)($,{order:y.tempOrder,ref:"orderModal",onUpdatePaid:k.updatePaid},null,8,["order","onUpdatePaid"]),(0,s.Wm)(O,{item:y.tempOrder,ref:"delModal",onDelItem:k.delOrder},null,8,["item","onDelItem"]),(0,s.Wm)(D,{pages:y.pagination,onEmitPages:k.getOrders},null,8,["pages","onEmitPages"])],64)}var y=i(7823);const k={class:"modal fade",id:"productModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"modal"},v={class:"modal-dialog modal-xl",role:"document"},$={class:"modal-content border-0"},O=(0,s._)("div",{class:"modal-header bg-dark text-white"},[(0,s._)("h5",{class:"modal-title",id:"exampleModalLabel"},[(0,s._)("span",null,"訂單細節")]),(0,s._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),D={class:"modal-body"},C={class:"row"},x={class:"col-md-4"},M=(0,s._)("h3",null,"用戶資料",-1),z={class:"table"},L={key:0},P=(0,s._)("th",{style:{width:"100px"}},"姓名",-1),T=(0,s._)("th",null,"Email",-1),A=(0,s._)("th",null,"電話",-1),E=(0,s._)("th",null,"地址",-1),j={class:"col-md-8"},q=(0,s._)("h3",null,"訂單細節",-1),N={class:"table"},S=(0,s._)("th",{style:{width:"100px"}},"訂單編號",-1),Z=(0,s._)("th",null,"下單時間",-1),B=(0,s._)("th",null,"付款時間",-1),H={key:0},Y={key:1},I=(0,s._)("th",null,"付款狀態",-1),U={key:0,class:"text-success"},R={key:1,class:"text-muted"},W=(0,s._)("th",null,"總金額",-1),K=(0,s._)("h3",null,"選購商品",-1),V={class:"table"},F=(0,s._)("thead",null,[(0,s._)("tr")],-1),Q={class:"text-end"},J={class:"modal-footer"},G=(0,s._)("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"},"取消 ",-1),X=["disabled"];function ee(e,t,i,n,l,d){return(0,s.wg)(),(0,s.iD)("div",k,[(0,s._)("div",v,[(0,s._)("div",$,[O,(0,s._)("div",D,[(0,s._)("div",C,[(0,s._)("div",x,[M,(0,s._)("table",z,[l.tempOrder.user?((0,s.wg)(),(0,s.iD)("tbody",L,[(0,s._)("tr",null,[P,(0,s._)("td",null,(0,a.zw)(l.tempOrder.user.name),1)]),(0,s._)("tr",null,[T,(0,s._)("td",null,(0,a.zw)(l.tempOrder.user.email),1)]),(0,s._)("tr",null,[A,(0,s._)("td",null,(0,a.zw)(l.tempOrder.user.tel),1)]),(0,s._)("tr",null,[E,(0,s._)("td",null,(0,a.zw)(l.tempOrder.user.address),1)])])):(0,s.kq)("",!0)])]),(0,s._)("div",j,[q,(0,s._)("table",N,[(0,s._)("tbody",null,[(0,s._)("tr",null,[S,(0,s._)("td",null,(0,a.zw)(l.tempOrder.id),1)]),(0,s._)("tr",null,[Z,(0,s._)("td",null,(0,a.zw)(e.$filters.date(l.tempOrder.create_at)),1)]),(0,s._)("tr",null,[B,(0,s._)("td",null,[l.tempOrder.paid_date?((0,s.wg)(),(0,s.iD)("span",H,(0,a.zw)(e.$filters.date(l.tempOrder.paid_date)),1)):((0,s.wg)(),(0,s.iD)("span",Y,"時間不正確"))])]),(0,s._)("tr",null,[I,(0,s._)("td",null,[l.tempOrder.is_paid?((0,s.wg)(),(0,s.iD)("strong",U,"已付款")):((0,s.wg)(),(0,s.iD)("span",R,"尚未付款"))])]),(0,s._)("tr",null,[W,(0,s._)("td",null,(0,a.zw)(e.$filters.currency(l.tempOrder.total)),1)])])]),K,(0,s._)("table",V,[F,(0,s._)("tbody",null,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(l.tempOrder.products,(t=>((0,s.wg)(),(0,s.iD)("tr",{key:t.id},[(0,s._)("th",null,(0,a.zw)(t.product.title),1),(0,s._)("td",null,(0,a.zw)(t.qty)+" / "+(0,a.zw)(t.product.unit),1),(0,s._)("td",Q,(0,a.zw)(e.$filters.currency(t.final_total)),1)])))),128))])])])])]),(0,s._)("div",J,[G,(0,s._)("button",{type:"button",disabled:l.isChecked,class:"btn btn-primary",onClick:t[0]||(t[0]=t=>e.$emit("update-order",l.tempOrder))},"確認",8,X)])])])],512)}var te=i(1339),ie={name:"orderModal",props:{order:{type:Object,default(){return{}}}},data(){return{status:{},modal:"",tempOrder:{},isPaid:!1,isChecked:!1}},emits:["update-order"],mixins:[te.Z],inject:["emitter"],watch:{order(){this.tempOrder=this.order,this.isPaid=this.tempOrder.is_paid}}},se=i(89);const ae=(0,se.Z)(ie,[["render",ee]]);var ne=ae,le=i(8534),de={data(){return{orders:{},isNew:!1,pagination:{},isLoading:!1,tempOrder:{},currentPage:1}},components:{Pagination:le.Z,DelModal:y.Z,OrderModal:ne},methods:{getOrders(e=1){this.currentPage=e;const t=`https://vue3-course-api.hexschool.io/api/wowcowman-api/admin/orders?page=${e}`;this.isLoading=!0,this.$http.get(t,this.tempProduct).then((e=>{this.orders=e.data.orders,this.pagination=e.data.pagination,this.isLoading=!1}))},openModal(e){this.tempOrder={...e},this.isNew=!1;const t=this.$refs.orderModal;t.showModal()},openDelOrderModal(e){this.tempOrder={...e};const t=this.$refs.delModal;t.showModal()},updatePaid(e){this.isLoading=!0;const t=`https://vue3-course-api.hexschool.io/api/wowcowman-api/admin/order/${e.id}`,i={is_paid:e.is_paid};this.$http.put(t,{data:i}).then((e=>{this.isLoading=!1,this.getOrders(this.currentPage),this.$httpMessageState(e,"更新付款狀態")}))},delOrder(){const e=`https://vue3-course-api.hexschool.io/api/wowcowman-api/admin/order/${this.tempOrder.id}`;this.isLoading=!0;const t=this.$refs.delModal;t.isChecked=!0,this.$http.delete(e).then((e=>{console.log(e),t.isChecked=!1,t.hideModal(),this.getOrders(this.currentPage)}))}},created(){this.getOrders()}};const oe=(0,se.Z)(de,[["render",f]]);var re=oe}}]);
//# sourceMappingURL=382.f071bce3.js.map